(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(75)},74:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(32),o=a.n(s),l=a(6),c=a(7),u=a(10),i=a(8),m=a(11),d=a(9),h=a.n(d),p=a(13),f=a(12),b=a(16),g=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(i.a)(t).call(this))).handleChange=function(t){t.persist(),e.setState(function(){return Object(b.a)({},t.target.name,t.target.value)})},e.handleSubmit=function(t){t.preventDefault(),h.a.post("/users/login",{user:e.state.user,password:e.state.password}).then(function(t){t.data.mfaRequired?(localStorage.setItem("otp-auth",t.data.token),e.props.history.push("/login/multi-auth")):t.data.token&&(localStorage.setItem("x-auth",t.data.token),localStorage.setItem("qr",t.data.mfa),e.props.updateUser(),e.props.history.push("/users"))}).catch(function(e){console.log(e.response.data.error)})},e.state={user:"",password:""},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"border p-5 m-auto rounded shadow",style:{"max-width":"380px"}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{value:this.state.user,name:"user",onChange:this.handleChange,type:"text",placeholder:"Email or Mobile",className:"form-control input-margin-custom border-bottom-custom"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{value:this.state.password,name:"password",onChange:this.handleChange,type:"password",placeholder:"Password",className:"form-control input-margin-custom border-bottom-custom"})),r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("button",{className:"btn btn-success rounded-pill custom-submit"},"Login"))))}}]),t}(r.a.Component),E=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(i.a)(t).call(this))).handleChange=function(t){t.persist(),e.setState(function(){return Object(b.a)({},t.target.name,t.target.value)})},e.handleSubmit=function(t){t.preventDefault(),h.a.post("/users",{email:e.state.email,mobile:e.state.mobile,password:e.state.password}).then(function(t){t.data.token&&(localStorage.setItem("qr",t.data.mfa),localStorage.setItem("x-auth",t.data.token),e.props.updateUser(),e.props.history.push("/users"))}).catch(function(e){console.log(e.response.data.error)})},e.state={email:"",mobile:"",password:""},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"border p-5 m-auto rounded shadow",style:{"max-width":"380px"}},r.a.createElement("h2",{className:"text-center"},"Welcome"),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{value:this.state.user,name:"email",onChange:this.handleChange,type:"text",placeholder:"Email",className:"form-control input-margin-custom border-bottom-custom"}),r.a.createElement("input",{value:this.state.mobile,name:"mobile",onChange:this.handleChange,type:"text",placeholder:"Mobile",className:"form-control input-margin-custom border-bottom-custom"}),r.a.createElement("input",{value:this.state.password,name:"password",onChange:this.handleChange,type:"password",placeholder:"Password",className:"form-control input-margin-custom border-bottom-custom"}),r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("button",{className:"btn btn-success rounded-pill custom-submit"},"Register")))))}}]),t}(r.a.Component),v=a(59),S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e){var t=e.target.checked;a.props.handleMfaChange(t)},a.state={mfaStatus:e.mfaStatus,email:e.email},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("form",null,r.a.createElement("div",{className:"border p-5 m-auto rounded shadow text-center",style:{"max-width":"380px"}},r.a.createElement("h2",{className:"mb-2"},"Settings"),r.a.createElement(v,{className:"mt-5 mb-5",value:localStorage.getItem("qr")})," ",r.a.createElement("br",null),r.a.createElement("h5",{className:""},this.state.email),r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:this.state.mfaStatus,onChange:this.handleChange}),"  Multi-Factor Authentication ")))}}]),t}(r.a.Component),j=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(i.a)(t).call(this))).handleSubmit=function(t){t.preventDefault(),console.log(localStorage.getItem("otp-auth")),h.a.post("/users/login/multi-auth",{otp:e.state.mfa},{headers:{"otp-auth":localStorage.getItem("otp-auth")}}).then(function(t){localStorage.setItem("x-auth",t.data.token),localStorage.setItem("qr",t.data.mfa),e.props.updateUser(),e.props.history.push("/users")})},e.handleChange=function(t){t.persist(),e.setState(function(){return{mfa:t.target.value}})},e.state={mfa:""},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"border p-5 m-auto rounded shadow",style:{"max-width":"380px"}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",placeholder:"MFA Token",onChange:this.handleChange,value:this.state.mfa,className:"form-control input-margin-custom border-bottom-custom"})),r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("button",{className:"btn btn-success rounded-pill custom-submit"},"Login"))))}}]),t}(r.a.Component),w=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(i.a)(t).call(this))).handleMfaChange=function(t){h.a.put("/users/mfa",{mfa:t},{headers:{"x-auth":localStorage.getItem("x-auth")}}).then(function(t){e.setState(function(){return{mfaStatus:t.data.mfa.on}})})},e.updateUser=function(){localStorage.getItem("x-auth")?h.a.get("/users",{headers:{"x-auth":localStorage.getItem("x-auth")}}).then(function(t){e.setState(function(){return{mfaStatus:t.data.mfa,email:t.data.email,isAuthenticated:!0}})}).catch(function(){e.setState(function(){return{isAuthenticated:!1}})}):e.setState(function(){return{isAuthenticated:!1}})},e.state={isAuthenticated:void 0,mfaStatus:void 0,email:void 0},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(p.a,null,void 0!==this.state.isAuthenticated&&r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{class:"navbar navbar-dark bg-dark mb-3"},r.a.createElement("div",{className:"d-flex w-100 li-parent justify-content-end",style:{listStyleType:"none"}},r.a.createElement("li",{className:"mr-auto"},r.a.createElement(p.b,{to:"/"},"Home")),this.state.isAuthenticated?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(p.b,{className:"nav-item",to:"/users"},"Settings")),r.a.createElement("li",null,r.a.createElement(p.b,{className:"nav-item",to:"/logout"},"Logout"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/register"},"Register")),r.a.createElement("li",null,r.a.createElement(p.b,{to:"/login"},"Login"))))),this.state.isAuthenticated?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{path:"/users",component:function(t){return r.a.createElement(S,Object.assign({},t,{mfaStatus:e.state.mfaStatus,email:e.state.email,handleMfaChange:e.handleMfaChange}))}}),r.a.createElement(f.a,{path:"/logout",component:function(t){return localStorage.clear(),e.updateUser(),t.history.push("/"),r.a.createElement(r.a.Fragment,null)}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{path:"/login",render:function(t){return r.a.createElement(g,Object.assign({},t,{updateUser:e.updateUser}))},exact:!0}),r.a.createElement(f.a,{path:"/register",render:function(t){return r.a.createElement(E,Object.assign({},t,{updateUser:e.updateUser}))}}),r.a.createElement(f.a,{path:"/login/multi-auth",render:function(t){return r.a.createElement(j,Object.assign({},t,{updateUser:e.updateUser}))},exact:!0})),r.a.createElement(f.a,{path:"/",exact:!0,render:function(){return r.a.createElement("div",{className:"border p-2 mt-5 mx-auto rounded shadow text-center",style:{"max-width":"480px"}},r.a.createElement("h3",{className:""},"About this App"),r.a.createElement("ol",null,r.a.createElement("li",null,"This app demonstrates Multi-Factor User Authentication."),r.a.createElement("li",null,"You will need Google Authenticator App to test this."),r.a.createElement("li",null,"Multi-Factor Authentication is turned off by default."),r.a.createElement("li",null,"This app saves your browser fingerprint, once logged in MFA wont be required again for that browser.")))}})))}},{key:"componentDidMount",value:function(){this.updateUser()}}]),t}(r.a.Component);a(73),a(74);o.a.render(r.a.createElement(w,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.8e8e73e7.chunk.js.map